using StaticArrays

function gaussSimplex(dim::Int, nip::Int)
	if dim == 1
		if nip == 1
			r  = 0.
			w  = 2.
			return ((r,), w)
		elseif nip == 2
			k  = 5.773502691896258e-01 # 1 / sqrt( 3);
			r  = SVector{2,Float64}(-k, k)
			w  = SVector{2,Float64}(1.0, 1.0)
			return ((r,), w)
		elseif nip == 3
			k  = 7.745966692414834e-01 # sqrt( 3 / 5)
			wm = 8.888888888888889e-01 # 8/9 = weight at middle of edge
			wc = 5.555555555555556e-01 # 5/9 = weight at corner of edge
			r  = SVector{3,Float64}(-k, 0.0, k)
			w  = SVector{3,Float64}(wc, wm, wc)
			return ((r,), w)
		elseif nip == 4
        	r = SVector{4,Float64}(
        	    -0.8611363115940526,
        	    -0.3399810435848563,
        	     0.3399810435848563,
        	     0.8611363115940526)
        	w = SVector{4,Float64}(
        	     0.3478548451374539,
        	     0.6521451548625461,
        	     0.6521451548625461,
        	     0.3478548451374539)
        	return ((r,), w)
    	elseif nip == 5
    	    r = SVector{5,Float64}(
    	        -0.9061798459386640,
    	        -0.5384693101056831,
    	         0.0,
    	         0.5384693101056831,
    	         0.9061798459386640)
    	    w = SVector{5,Float64}(
    	         0.2369268850561891,
    	         0.4786286704993665,
    	         0.5688888888888889,
    	         0.4786286704993665,
    	         0.2369268850561891)
    	    return ((r,), w)
    	elseif nip == 6
    	    r = SVector{6,Float64}(
    	        -0.9324695142031520,
    	        -0.6612093864662645,
    	        -0.2386191860831969,
    	         0.2386191860831969,
    	         0.6612093864662645,
    	         0.9324695142031520)
    	    w = SVector{6,Float64}(
    	         0.1713244923791704,
    	         0.3607615730481386,
    	         0.4679139345726910,
    	         0.4679139345726910,
    	         0.3607615730481386,
    	         0.1713244923791704)
    	    return ((r,), w)
    	elseif nip == 7
    	    r = SVector{7,Float64}(
    	        -0.9491079123427585,
    	        -0.7415311855993945,
    	        -0.4058451513773972,
    	         0.0,
    	         0.4058451513773972,
    	         0.7415311855993945,
    	         0.9491079123427585)
    	    w = SVector{7,Float64}(
    	         0.1294849661688697,
    	         0.2797053914892766,
    	         0.3818300505051189,
    	         0.4179591836734694,
    	         0.3818300505051189,
    	         0.2797053914892766,
    	         0.1294849661688697)
    	    return ((r,), w)
    	elseif nip == 8
    	    r = SVector{8,Float64}(
    	        -0.9602898564975363,
    	        -0.7966664774136267,
    	        -0.5255324099163290,
    	        -0.1834346424956498,
    	         0.1834346424956498,
    	         0.5255324099163290,
    	         0.7966664774136267,
    	         0.9602898564975363)
    	    w = SVector{8,Float64}(
    	         0.1012285362903763,
    	         0.2223810344533745,
    	         0.3137066458778873,
    	         0.3626837833783620,
    	         0.3626837833783620,
    	         0.3137066458778873,
    	         0.2223810344533745,
    	         0.1012285362903763)
    	    return ((r,), w)
    	elseif nip == 9
    	    r = SVector{9,Float64}(
    	        -0.9681602395076261,
    	        -0.8360311073266358,
    	        -0.6133714327005904,
    	        -0.3242534234038089,
    	         0.0,
    	         0.3242534234038089,
    	         0.6133714327005904,
    	         0.8360311073266358,
    	         0.9681602395076261)
    	    w = SVector{9,Float64}(
    	         0.0812743883615744,
    	         0.1806481606948574,
    	         0.2606106964029354,
    	         0.3123470770400029,
    	         0.3302393550012598,
    	         0.3123470770400029,
    	         0.2606106964029354,
    	         0.1806481606948574,
    	         0.0812743883615744)
    	    return ((r,), w)
    	elseif nip == 10
    	    r = SVector{10,Float64}(
    	        -0.9739065285171717,
    	        -0.8650633666889845,
    	        -0.6794095682990244,
    	        -0.4333953941292472,
    	        -0.1488743389816312,
    	         0.1488743389816312,
    	         0.4333953941292472,
    	         0.6794095682990244,
    	         0.8650633666889845,
    	         0.9739065285171717)
    	    w = SVector{10,Float64}(
    	         0.0666713443086881,
    	         0.1494513491505806,
    	         0.2190863625159820,
    	         0.2692667193099963,
    	         0.2955242247147529,
    	         0.2955242247147529,
    	         0.2692667193099963,
    	         0.2190863625159820,
    	         0.1494513491505806,
    	         0.0666713443086881)
    	    return ((r,), w)
    	else
    		error("gaussSimplex: dim $dim, nip $nip combination not supported")
		end
	elseif dim == 2
	#  integration points for two dimensions
		if nip == 1 # polynomial degree 1
			m1 = 0.333333333333333
			r  = SVector{1,Float64}(m1)
			s  = SVector{1,Float64}(m1)
			w  = SVector{1,Float64}(0.5)
			return ((r,s), w)
		elseif nip == 3 # polynomial degree 2
			w1 = 0.166666666666667
			w2 = 0.666666666666667
			r = SVector{3,Float64}(w1, w2, w1)
			s = SVector{3,Float64}(w1, w1, w2)
			w = SVector{3,Float64}(w1, w1, w1)
			return ((r,s), w)
		elseif nip == 4 # polynomial degree 3
			w1 = 0.260416666666667
			w2 = -0.281250000000000
			r1 = 0.200000000000000
			r2 = 0.600000000000000
			r3 = 0.333333333333333
			r = SVector{4,Float64}(r1, r2, r1, r3)
			s = SVector{4,Float64}(r1, r1, r2, r3)
			w = SVector{4,Float64}(w1, w1, w1, w2)
			return ((r,s), w)
		elseif nip == 6 # polynomial degree 4
			a = 0.445948490915965
			b = 0.091576213509771
			w1 = 0.111690794839005
			w2 = 0.054975871827661
			r = SVector{6,Float64}(a, 1.0-2.0*a, a, b, 1.0-2.0*b, b)
			s = SVector{6,Float64}(a, a, 1.0-2.0*a, b, b, 1.0-2.0*b)
			w = SVector{6,Float64}(w1, w1, w1, w2, w2, w2)
			return ((r,s), w)
		elseif nip==7
			a = 0.059715871789770
            b = 0.470142064105115
            c = 0.797426985353087
            d = 0.101286507323456
            w1 = 0.225000000000000
            w2 = 0.132394152788506
            w3 = 0.125939180544827
            r = SVector{7,Float64}(1/3,  a, b, b, c, d, d)
            s = SVector{7,Float64}(1/3,  b, a, b, d, c, d)
            w = SVector{7,Float64}(w1, w2, w2, w2, w3, w3, w3) .* 0.5
            return ((r,s), w)
            elseif nip == 12
        r = SVector{12,Float64}(
            0.249286745170910, 0.249286745170910, 0.501426509658179,
            0.063089014491502, 0.063089014491502, 0.873821971016996,
            0.310352451033785, 0.636502499121399, 0.053145049844816,
            0.636502499121399, 0.310352451033785, 0.053145049844816)
        s = SVector{12,Float64}(
            0.249286745170910, 0.501426509658179, 0.249286745170910,
            0.063089014491502, 0.873821971016996, 0.063089014491502,
            0.636502499121399, 0.053145049844816, 0.310352451033785,
            0.310352451033785, 0.053145049844816, 0.636502499121399)
        w = SVector{12,Float64}(
            0.116786275726379, 0.116786275726379, 0.116786275726379,
            0.050844906370207, 0.050844906370207, 0.050844906370207,
            0.082851075618374, 0.082851075618374, 0.082851075618374,
            0.082851075618374, 0.082851075618374, 0.082851075618374) .* 0.5
        return ((r,s), w)
    elseif nip == 13
        r = SVector{13,Float64}(
            1/3, 0.479308067841920, 0.260345966079040, 0.260345966079040,
            0.869739794195568, 0.065130102902216, 0.065130102902216,
            0.048690315425316, 0.312865496004874, 0.638444188569810,
            0.638444188569810, 0.312865496004874, 0.048690315425316)
        s = SVector{13,Float64}(
            1/3, 0.260345966079040, 0.479308067841920, 0.260345966079040,
            0.065130102902216, 0.869739794195568, 0.065130102902216,
            0.312865496004874, 0.048690315425316, 0.312865496004874,
            0.048690315425316, 0.638444188569810, 0.638444188569810)
        w = SVector{13,Float64}(
            -0.149570044467682,
            0.175615257433204, 0.175615257433204, 0.175615257433204,
            0.053347235608838, 0.053347235608838, 0.053347235608838,
            0.077113760890257, 0.077113760890257, 0.077113760890257,
            0.077113760890257, 0.077113760890257, 0.077113760890257) .* 0.5
        return ((r,s), w)
		else
			error("gaussSimplex: dim $dim, nip $nip combination not supported")
		end
		return nothing
	end
end